<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Unison.js</title>
  <link rel="stylesheet" href="css/unison.css" />
  <link href="http://fonts.googleapis.com/css?family=Josefin+Slab:400italic|Source+Sans+Pro:300,400,600" rel="stylesheet" type="text/css" />
</head>
<body>

  <div class="m-hero">
    <h1>Unison.js</h1>
    <small>Unifying named breakpoints across CSS, JS, and HTML</small>
  </div>

  <div class="m-container">

    <div class="m-call-to-action">
      <a href="" id="js-toggle-info" class="m-button">Toggle breakpoint info</a>
      <a href="http://www.github.com/bjork24/Unison" id="js-toggle-info" class="m-button">View on GitHub</a>
    </div>

    <h2>What is Unison.js</h2>

    <p><strong>Unison.js</strong> is a small plugin (450 bytes minified, 144 bytes gzipped) that allows you to declare named breakpoints in one place and automatically sync them across your javascript and markup. When all of your front-end technologies share breakpoint information, complex responsive tasks such as conditional loading and image swapping become much simpler and straight-forward.</p>

    <h2>How does it work</h2>

    <p>To take full advantage of <strong>Unison.js</strong>, you'll need to be using a css pre-processor such as <a href="http://sass-lang.com/" target="_blank">SASS</a>, <a href="http://lesscss.org/" target="_blank">LESS</a>, <a href="http://learnboost.github.io/stylus/" target="_blank">Stylus</a>. Currently, Unison is only set up to use SASS, but LESS and Stylus implimentations are on the way. To begin, declare your breakpoints in your <a href="https://github.com/bjork24/Unison/blob/master/css/_breakpoints.scss#L4-L11" target="_blank"><em>_breakpoints.scss</em></a> partial as you normally would:</p>

<pre>
$usn-x-small         : 200px;
$usn-small           : 400px;
$usn-small-medium    : 600px;
$usn-medium          : 800px;
$usn-large-medium    : 1000px;
$usn-large           : 1200px;
$usn-x-large         : 1400px;
</pre>

    <p>These are the breakpoint names that you'll use in your markup and javascript to trigger events as well. This is the only place in your project that you'll need to declare your breakpoints. Whenever these values change, they'll be synced across your code automatically. After you've declared your breakpoints, you'll need to include the names in a second block so the CSS can pass them to the javascript.</p>

<pre>
$mq-sync:
  usn-x-small        $usn-x-small,
  usn-small          $usn-small,
  usn-small-medium   $usn-small-medium,
  usn-medium         $usn-medium,
  usn-large-medium   $usn-large-medium,
  usn-large          $usn-large,
  usn-x-large        $usn-x-large
;
</pre>

    <p>This bit of code may look redundant, but it's required to broadcast the names of each breakpoint outside of your stylesheet -- or at least until SASS figures out a way to parse variable variables. As mentioned in the comments of <a href="https://github.com/bjork24/Unison/blob/master/css/_breakpoints.scss#L13-L24" target="_blank"><em>_breakpoints.scss</em></a>, if you ever change the name of your break point, you'll have to update it in this block as well. Once you've named and declared your breakpoints, place the <strong>Unison.js</strong> script on your page:</p>

<pre>
&lt;script src="unison.min.js">&lt;/script>
</pre>

    <p>And that's all there is to it! You're named breakspaces are now available in any of your javascript files. To test, open your javascript console and type <em>Unison.getBreakpoints()</em>. If everything is set up correctly, the console will return two objects: one with your current breakpoint's name and value, and a second containing a hash of the other breakpoints you declared in your <em>_breakpoints.scss</em> file.</p>

    <h2>Interacting with breakpoint data</h2>

    <p>While building out your responsive design, it's helpful to see which breakpoint you're currently working with, and <strong>Unison.js</strong> makes that data easily available. Simply set <em>$debug: true;</em> in your <em>_breakpoints.scss</em> file and your current breakpoint data will be appended to your page for easy debugging. To see this in action, click the "Toggle breakpoint info" button at the top of the page and resize your browser.</p>

    <p>You can access the breakpoint objects from your javascript by calling <em>Unison.getBreakpoints()</em>, or by chaining off the object to drill down for more specific data.</p>

<pre>
var breakpointData = Unison.getBreakpoints();

// breakpointData = {
//   allBP : {
//     usn-large : "1200px"
//     usn-large-medium : "1000px"
//     usn-medium : "800px"
//     usn-small : "400px"
//     usn-small-medium : "600px"
//     usn-x-large : "1400px"
//     usn-x-small : "200px"
//   },
//   currentBP : {
//     name : "usn-large"
//     width : "1200px"
//   }
// }

var allBreakpoints = Unison.getBreakpoints().allBP;

// allBreakpoints = {
//   usn-large : "1200px"
//   usn-large-medium : "1000px"
//   usn-medium : "800px"
//   usn-small : "400px"
//   usn-small-medium : "600px"
//   usn-x-large : "1400px"
//   usn-x-small : "200px"
// }

var currentBPval = Unison.getBreakpoints().currentBP.width;

// currentBPval = "1200px"
</pre>

    <h2>Conditional loading with Responsive Comments</h2>

    <p>To showcase the utility of <strong>Unison.js</strong>, we decided to refactor one our favorite responsive design tools, <a href="https://twitter.com/chambaz" target="_blank">Adam Chambers'</a> <a href="http://responsivecomments.com/" target="_blank">Responsive Comments</a>, so it could take advantage of synced breakpoints. If you're not familiar with it already, Responsive Comments is an ingenius javascript plugin that allows client-side conditional loading, instead of relying on media queries alone or server-side detection (e.g. <a href="http://bradfrost.github.io/this-is-responsive/resources.html#development" target="_blank">RESS</a>). By hiding bandwidth-heavy modules in simple HTML comments, and only loading them once the screen has hit a certain breakpoint, you can increase the performance of your mobile experience significantly. To that end, we created our first <strong>Unison.js</strong> plugin: <a href="https://github.com/bjork24/Unison/blob/master/js/unison-responsive-comments.js"><em>unison-responsive-comments.js</em></a>.</p>

    <p>Using the same named breakpoints that we declared in our original <em>_breakpoints.scss</em> file, we can now specify which modules we want to load conditionally based on the our current breakpoint right in the markup. We've included three pictures of Björk below this paragraph that are conditionally loaded only when a certain named breakpoint is fired. All you have to do is specify the breakpoint in your markup in a <em>data-usn-load-if</em> attribute.</p>

<pre>
&lt;div data-usn-load-if="usn-medium">
  &lt;!--
  &lt;hr/>
  &lt;div class="m-bjork medium">
    &lt;img src="img/medium.jpg" />
  &lt;/div>
  -->
&lt;/div>
</pre>

    <p><strong>NOTE:</strong> If you resize your browser back and forth, you will notice that the larger photos load in once you pass a breakpoint, but don't disappear when you resize to a smaller width. That's intended behavior. Conditional loading is not a replacement for media queries; it's sole responsibility is loading in content when a breakpoint is met, not hiding it at smaller sizes.</p>

    <div data-usn-load-if="usn-large" id="large-bjork">
      <!--
      <hr/>
      <div class="m-bjork large">
        <img src="img/large.jpg" />
        <cite>This is a <strong>large</strong> picture of Björk that only loads if the screen is larger than the <strong>usn-large</strong> breakpoint.</cite>
      </div>
      -->
    </div>

    <div data-usn-load-if="usn-medium">
      <!--
      <hr/>
      <div class="m-bjork medium">
        <img src="img/medium.jpg" />
        <cite>This is a <strong>medium</strong> picture of Björk that only loads if the screen is larger than the <strong>usn-medium</strong> breakpoint.</cite>
      </div>
      -->
    </div>

    <div data-usn-load-if="usn-small" id="small-bjork">
      <!--
      <hr/>
      <div class="m-bjork small">
        <img src="img/small.jpg" />
        <cite>This is a <strong>small</strong> picture of Björk that only loads if the screen is larger than the <strong>usn-small</strong> breakpoint.</cite>
      </div>
      <hr/>
      -->
    </div>

    <p>Another powerful feature of Responsive Comments is the ability to tie custom events to conditionally-loaded content. We've added IDs to the largest and smallest Björk pictures, and fire a message to the console whenever they're successfully loaded into the DOM.</p>

<pre>
document.getElementById('large-bjork').addEventListener('unisonResponse', function(e) {
  console.log('The large photo of Björk loaded successfully!');
});
document.getElementById('small-bjork').addEventListener('unisonResponse', function(e) {
  console.log('The small photo of Björk loaded successfully!');
});
</pre>

  <h2>Disclaimer</h2>

  <p>This plugin should be considered beta. We haven't had a chance to test it fully across older browsers, but it should perform fine on modern browsers. Also, since the <em>unison-responsive-comments.js</em> plugin relies on <em>matchMedia</em>, you will need to use a polyfill for IE9 and below compatability, or set the <em>noMatchMediaSize</em> variable to the size of screen you'd like the script to default to for non-compliant browsers.</p>

  </div>

  <script>
    document.getElementById('large-bjork').addEventListener('unisonResponse', function(e) {
      console.log('The large photo of Björk loaded successfully!');
    });
    document.getElementById('small-bjork').addEventListener('unisonResponse', function(e) {
      console.log('The small photo of Björk loaded successfully!');
    });
  </script>
  <script src="js/page.min.js"></script>
</body>
</html>