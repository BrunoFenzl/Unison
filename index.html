<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Unison.js</title>
  <link rel="stylesheet" href="css/breakpoints.css" />
  <link rel="stylesheet" href="css/unison.css" />
  <link href="http://fonts.googleapis.com/css?family=Josefin+Slab:400italic|Source+Sans+Pro:300,400,600" rel="stylesheet" type="text/css" />
  <script src="js/page.js"></script>
</head>
<body>

  <div class="m-hero">
    <h1>Unison.js</h1>
    <small>Unifying named breakpoints across CSS, JS, and HTML</small>
  </div>

  <div class="m-container">

    <div class="m-call-to-action">
      <a href="" id="js-toggle-info" class="m-button">Toggle breakpoint info</a>
      <a href="http://www.github.com/bjork24/Unison" id="js-toggle-info" class="m-button">View on GitHub</a>
    </div>

    <h2>What is Unison.js</h2>

    <p><strong>Unison.js</strong> is a small plugin (1.2kb minified) that allows you to declare named breakpoints in one place and automatically sync them across your javascript and markup. When all of your front-end technologies share breakpoint information, complex responsive tasks such as conditional loading and image swapping become much simpler and straight-forward.</p>

    <h2>How does it work</h2>

    <p>To take full advantage of <strong>Unison.js</strong>, you'll need to be using a css pre-processor such as <a href="http://sass-lang.com/" target="_blank">SASS</a>, <a href="http://lesscss.org/" target="_blank">LESS</a>, or <a href="http://learnboost.github.io/stylus/" target="_blank">Stylus</a>. To begin, declare your breakpoints in your breakpoints partial as you normally would:</p>

<pre>
// SASS
$usn-x-small         : 200px;
$usn-small           : 400px;
$usn-small-medium    : 600px;
$usn-medium          : 800px;
$usn-large-medium    : 1000px;
$usn-large           : 1200px;
$usn-x-large         : 1400px;

// LESS
@usn-x-small         : 200px;
@usn-small           : 400px;
@usn-small-medium    : 600px;
@usn-medium          : 800px;
@usn-large-medium    : 1000px;
@usn-large           : 1200px;
@usn-x-large         : 1400px;

// STYLUS
$usn-x-small         = 200px
$usn-small           = 400px
$usn-small-medium    = 600px
$usn-medium          = 800px
$usn-large-medium    = 1000px
$usn-large           = 1200px
$usn-x-large         = 1400px
</pre>

    <p>These are the breakpoint names that you'll use in your markup and javascript to trigger events as well. This is the only place in your project that you'll need to declare your breakpoints. Whenever these values change, they'll be synced across your code automatically. After you've declared your breakpoints, you'll need to include the names in a second block so the CSS can pass them to the javascript.</p>

<pre>
// SASS
$mq-sync:
  usn-x-small        $usn-x-small,
  usn-small          $usn-small,
  usn-small-medium   $usn-small-medium,
  usn-medium         $usn-medium,
  usn-large-medium   $usn-large-medium,
  usn-large          $usn-large,
  usn-x-large        $usn-x-large
;

// LESS
@breakpoints: "usn-x-small @{usn-x-small}",
              "usn-small @{usn-small}",
              "usn-small-medium @{usn-small-medium}",
              "usn-medium @{usn-medium}",
              "usn-large-medium @{usn-large-medium}",
              "usn-large @{usn-large}",
              "usn-x-large @{usn-x-large}";

// STYLUS
$mq-sync = usn-x-small        $usn-x-small,
           usn-small          $usn-small,
           usn-small-medium   $usn-small-medium,
           usn-medium         $usn-medium,
           usn-large-medium   $usn-large-medium,
           usn-large          $usn-large,
           usn-x-large        $usn-x-large
</pre>

    <p>This bit of code may look redundant, but it's required to broadcast the names of each breakpoint outside of your stylesheet. As mentioned in the comments of the breakpoint file, if you ever change the name of your break point, you'll have to update it in this block as well. Once you've named and declared your breakpoints, place the <strong>Unison.js</strong> script on your page:</p>

<pre>
&lt;script src="unison.min.js">&lt;/script>
</pre>

    <p>And that's all there is to it! Your named breakspaces are now available in any of your javascript files. To test, open your javascript console and type <em>Unison.fetch.all()</em>. If everything is set up correctly, the console will return an object containing a hash of the breakpoints you declared in your <em>breakpoints</em> file. If your CSS is not correctly passing breakpoint variables, <em>Unison.fetch.all()</em> will return <em>null</em>.</p>

    <h2>Behind the scenes</h2>

    <p>The <em>breakpoints</em> file is using the <em>font-family</em> property on the page's <em>head</em> and <em>title</em> tags to store information. For each breakpoint you set, the current value is set and updated on your <em>head</em> tag, while the full hash of breakpoints is stored in the <em>title</em> tag. <strong>Unison.js</strong> simply parses the <em>font-family</em> property of each tag and stores them as a globally-accessible object. Simple and efficient!</p>

    <h2>Displaying breakpoint data</h2>

    <p>While building out your responsive design, it's helpful to see which breakpoint you're currently working with, and <strong>Unison.js</strong> makes that data easily available. Simply set the <em>debug</em> variable to <em>true</em> in your <em>breakpoints</em> file and your current breakpoint data will be appended to your page for easy debugging. To see this in action, click the "Toggle breakpoint info" button at the top of the page and resize your browser.</p>

    <h2>Acessing breakpoint data in your javascript</h2>

    <p>The <em>Unison</em> object is globally available, which allows you to easily access your breakpoint data with the <em>Unison.fetch</em> method.</p>

<pre>
var allBreakpoints = Unison.fetch.all();

// allBreakpoints = {
//   usn-x-small      : "200px",
//   usn-small        : "400px",
//   usn-small-medium : "600px",
//   usn-medium       : "800px",
//   usn-large-medium : "1000px",
//   usn-large        : "1200px",
//   usn-x-large      : "1400px"
// }

var currentBreakpoint = Unison.fetch.now();

// currentBreakpoint = {
//   name   : "usn-large",
//   width  : "1200px"
// }

var currentBPval = parseInt(Unison.fetch.now().width);

// currentBPval = 1200
</pre>

    <h2>Breakpoint events</h2>

    <p><strong>Unison.js</strong> allows you to add breakpoint listeners in your javascript using the <em>Unison.on()</em> function. The declared functions will fire every time the screen is resized to the size specified in your breakpoint file. This is done without using <em>matchMedia</em>, which makes it compatable with IE9.</p>
    <p>This page is currently running the following listeners</p>

<pre>
Unison.on('usn-medium', function() {
  console.log('medium breakpoint');
});
Unison.on('usn-small', function() {
  console.log('small breakpoint');
});
Unison.on('usn-medium', function() {
  console.log('another medium function');
});
</pre>

    <p>There's also a generic <em>Unison.on('change')</em> event that will fire whenever the breakpoint changes and return the new breakpoint's data to your callback function. This page is using:</p>

<pre>
Unison.on('change', function(bp) {
  console.log('breakpoint changed!');
  console.log(bp);
});
</pre>

    <p>The <em>Unison.on('change')</em> allows you to easily organize your breakpoint-specific functions.</p>

<pre>
Unison.on('change', function(bp) {
  switch ( bp.name ) {
    case 'usn-small':
      mySmallBreakpointFunction();
      break;
    case 'usn-medium':
      myMediumBreakpointFunction();
      break;
    case 'usn-large':
      myLargeBreakpointFunction();
      break;
  }
});
</pre>

    <h2>Conditional loading with Responsive Comments</h2>

    <p>To showcase the utility of <strong>Unison.js</strong>, we decided to refactor one our favorite responsive design tools, <a href="https://twitter.com/chambaz" target="_blank">Adam Chambers'</a> <a href="http://responsivecomments.com/" target="_blank">Responsive Comments</a>, so it could take advantage of synced breakpoints. If you're not familiar with it already, Responsive Comments is an ingenius javascript plugin that allows client-side conditional loading, instead of relying on media queries alone or server-side detection (e.g. <a href="http://bradfrost.github.io/this-is-responsive/resources.html#development" target="_blank">RESS</a>). By hiding bandwidth-heavy modules in simple HTML comments, and only loading them once the screen has hit a certain breakpoint, you can increase the performance of your mobile experience significantly. To that end, we created our first <strong>Unison.js</strong> plugin: <a href="https://github.com/bjork24/Unison/blob/master/js/unison-responsive-comments.js"><em>unison-responsive-comments.js</em></a>.</p>

    <p>Using the same named breakpoints that we declared in our original <em>_breakpoints.scss</em> file, we can now specify which modules we want to load conditionally based on the our current breakpoint right in the markup. We've included three pictures of Björk below this paragraph that are conditionally loaded only when a certain named breakpoint is fired. All you have to do is specify the breakpoint in your markup in a <em>data-usn-load-if</em> attribute.</p>

<pre>
&lt;div data-usn-load-if="usn-medium">
  &lt;!--
  &lt;hr/>
  &lt;div class="m-bjork medium">
    &lt;img src="img/medium.jpg" />
  &lt;/div>
  -->
&lt;/div>
</pre>

    <div data-usn-load-if="usn-large" id="large-bjork">
      <!--
      <hr/>
      <div class="m-bjork large">
        <img src="img/large.jpg" />
        <cite>This is a <strong>large</strong> picture of Björk that only loads if the screen is larger than the <strong>usn-large</strong> breakpoint.</cite>
      </div>
      -->
    </div>

    <div data-usn-load-if="usn-medium">
      <!--
      <hr/>
      <div class="m-bjork medium">
        <img src="img/medium.jpg" />
        <cite>This is a <strong>medium</strong> picture of Björk that only loads if the screen is larger than the <strong>usn-medium</strong> breakpoint.</cite>
      </div>
      -->
    </div>

    <div data-usn-load-if="usn-small" id="small-bjork">
      <!--
      <hr/>
      <div class="m-bjork small">
        <img src="img/small.jpg" />
        <cite>This is a <strong>small</strong> picture of Björk that only loads if the screen is larger than the <strong>usn-small</strong> breakpoint.</cite>
      </div>
      <hr/>
      -->
    </div>

    <p><strong>NOTE:</strong> If you resize your browser back and forth, you will notice that the larger photos load in once you pass a breakpoint, but don't disappear when you resize to a smaller width. That's intended behavior. Conditional loading is not a replacement for media queries; it's sole responsibility is loading in content when a breakpoint is met, not hiding it at smaller sizes.</p>

    <p>Another powerful feature of Responsive Comments is the ability to tie custom events to conditionally-loaded content. We've added IDs to the largest and smallest Björk pictures, and fire a message to the console whenever they're successfully loaded into the DOM.</p>

<pre>
Unison.ConditionalLoad.loads('large-bjork', function() {
  console.log('The large photo of Björk loaded successfully!');
});
Unison.ConditionalLoad.loads('small-bjork', function() {
  console.log('The small photo of Björk loaded successfully!');
});
</pre>

  <h2>Acknowledgements</h2>

  <p><strong>Unison.js</strong> is influenced by <a href="http://www.brettjankord.com/" target="_blank">Brett Jankord's</a> <a href="https://github.com/bjankord/Media-Query-Sync" target="_blank">Media Query Sync</a>.</p>

  <h2>Disclaimer</h2>

  <p>This plugin should be considered beta. We haven't had a chance to test it fully across older browsers, but it should perform fine on modern browsers (IE9+).</p>

  <h2>License</h2>

  <p>The MIT License (MIT)</p>

  <p>Copyright (c) 2014 <a href="http://www.danchilton.com" target="_blank">Dan Chilton</a></p>

  <p>Permission is hereby granted, free of charge, to any person obtaining a copy of
  this software and associated documentation files (the "Software"), to deal in
  the Software without restriction, including without limitation the rights to
  use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
  the Software, and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:</p>

  <p>The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.</p>

  <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
  FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
  COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
  IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>

  </div>

  <script>
    Unison.ConditionalLoad.loads('large-bjork', function() {
      console.log('The large photo of Björk loaded successfully!');
    });
    Unison.ConditionalLoad.loads('small-bjork', function() {
      console.log('The small photo of Björk loaded successfully!');
    });
  </script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-46421732-1', 'bjork24.github.io');
    ga('send', 'pageview');
  </script>

</body>
</html>
